<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title></title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link rel="icon" type="image/png" href="img/logo.png" />
    <link href="ScanCode.Web.Wasm.styles.css" rel="stylesheet">
    <link href="_content/MudBlazor/MudBlazor.min.css" rel="stylesheet" />

    <style>

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-image: linear-gradient(rgba(107, 204, 242,0.3), rgba(0, 0, 254, 0.450)),url('imgs/top_image.png'),url('imgs/middle_image.png'), url('imgs/bottom_image.png');
            background-repeat: no-repeat;
            background-position: center top, center top, /* é¡¶éƒ¨å›¾ç‰‡ */
            right calc(100% - 300px), bottom; /* åº•éƒ¨å›¾ç‰‡ */
            background-size: contain, /* çº¿æ€§æ¸å˜ */
            contain, /* é¡¶éƒ¨å›¾ç‰‡ */
            200px, /* ä¸­é—´å›¾ç‰‡ */
            100% auto; /* åº•éƒ¨å›¾ç‰‡ */
        }
    </style>
</head>

<body>
    <div id="app">
        <style>
            .mud-wasm-cont {
                left: 50%;
                padding: 10vmin;
                position: fixed;
                text-align: center;
                top: 50%;
                transform: translate(-50%, -50%)
            }
        </style>
        <div style="height: 100%; width: 100%; margin: 0; position: fixed;">
            <div class="mud-wasm-cont ">
                <img src="imgs/colorlogo.png" width="100%" />
            </div>
        </div>
    </div>
    <!--<div id="app">
    <style>
        @keyframes slide {
            0% {
                transform: translateX(-25%);
            }

            100% {
                transform: translateX(25%);
            }
        }

        .mud-wasm {
            animation: slide 2s ease-in-out infinite alternate;
            background-image: linear-gradient(-45deg, #00557C 50%, #1BA6D2 50%);
            bottom: 0;
            left: -50%;
            opacity: .5;
            position: fixed;
            right: -50%;
            top: 0;
            z-index: -1
        }

        .mud-wasm-cont {
            left: 50%;
            padding: 10vmin;
            position: fixed;
            text-align: center;
            top: 50%;
            transform: translate(-50%, -50%)
        }
    </style>-->

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ğŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="_content/MudBlazor/MudBlazor.min.js"></script>
    <script>

        //window.getCookie = function (name) {
        //    var match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
        //    if (match) return match[2];
        //}
        async function fetchOAuthUrl() {
            try {
                const url = window.location.href;
                console.log('window.location.href:', url);
                const pattern = /(\d{12})$/;
                const match = url.match(pattern);
                if (match) {

                    const urlqrcode = match[0];
                    console.log('match:', urlqrcode);

                    const oauthUrl = "https://www.rewt.cn/OAuth2Url?qrcode=" + urlqrcode;

                    console.log('oauthUrl:', oauthUrl);
                    const response = await fetch(oauthUrl, { method: 'GET', mode: 'cors' });

                    if (!response.ok) {
                        throw new Error('æœªèƒ½è®¿é—®OAuth ç½‘å€ã€‚');
                    };
                    const content = await response.text();
                    console.log('response.text():', content);
                    window.location.href = content;
                } else {
                    console.log('æ‰¾ä¸åˆ°äºŒç»´ç åºå·:', url);
                }

            } catch (error) {
                console.error('fetchOAuthUrl() Error:', error);
            }
        }
        const params = new URLSearchParams(window.location.search);
        if (params.has('code')) {
            // URL åŒ…å« "code" æŸ¥è¯¢å‚æ•°, ä»ä¸­è·å– "code" å€¼.
            const code = params.get('code');
            // åœ¨è¿™é‡Œæ‰§è¡Œç›¸åº”çš„ä»£ç 
        } else {
            // URL ä¸åŒ…å« "code" æŸ¥è¯¢å‚æ•°, é‡å®šå‘åˆ°å¾®ä¿¡ OAuth æˆæƒé¡µé¢.

            console.log('URL ä¸åŒ…å« "code" æŸ¥è¯¢å‚æ•°, é‡å®šå‘åˆ°å¾®ä¿¡ OAuth æˆæƒé¡µé¢.');
            fetchOAuthUrl();
        }
    </script>
</body>
</html>